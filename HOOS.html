<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HOOS ‚Äì Hip Osteoarthritis Outcome Score</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="robotoBase64.js"></script>

<style>
  body { font-family: sans-serif; margin: 2rem; font-size: 16px; max-width: 960px; }
  h1 { margin-bottom: .25rem; }
  .subtitle { margin-bottom: 1rem; color:#333; }
  .intro { margin: .9rem 0 1.3rem; }
  .section { margin-top: 1.7rem; }
  .section-note { margin: .5rem 0 .8rem; color:#333; }
  .qblock { margin: 1rem 0 1.3rem; }
  .qtitle { font-weight: 600; margin-bottom: .55rem; }
  .grid { width: 100%; border-collapse: collapse; margin-top: .3rem; }
  .grid th, .grid td { padding: .45rem .5rem; border:1px solid #ccc; text-align:center; }
  .grid th:first-child, .grid td:first-child { text-align:left; }
  button { padding:10px 15px; margin-top:18px; font-size:16px; cursor:pointer; }
  #result { margin-top: 20px; font-weight:700; white-space: pre-line; }
</style>
</head>

<body>

<h1>Hip Osteoarthritis Outcome Score (HOOS)</h1>
<div class="subtitle">(validierte deutsche Version, Blasimann 2014)</div>

<p class="intro">
Der folgende Fragebogen dient der Erfassung von Beschwerden und Problemen, die durch Ihr H√ºftgelenk verursacht werden.
Die dadurch gewonnenen Informationen werden uns helfen einzusch√§tzen, wie es Ihnen mit Ihrer H√ºfte geht und wie gut Sie in der Lage sind, Ihre √ºblichen Aktivit√§ten zu verrichten.
Beantworten Sie bitte jede Frage durch Ankreuzen des zugeh√∂rigen K√§stchens. Bitte nur ein K√§stchen pro Frage ankreuzen.
Wenn Sie sich unsicher sind, wie Sie die Frage beantworten sollen, w√§hlen Sie die Antwort aus, die Ihnen am zutreffendsten erscheint.
Bitte beantworten Sie alle Fragen gem√§√ü Ihrem aktuellen Zustand. Sollten Sie momentan keine Beschwerden haben, dann bewerten Sie die Fragen entsprechend Ihrem Zustand in der vergangenen Woche.
</p>

<!-- Reihenfolge & Inhalte gem√§√ü deinem Text -->
<div id="symptoms" class="section"><h2>Subskala Symptome</h2></div>
<div id="pain" class="section"><h2>Subskala Schmerz</h2></div>
<div id="adl" class="section"><h2>Subskala Aktivit√§ten des allt√§glichen Lebens</h2></div>
<div id="sport" class="section"><h2>Subskala sportliche Aktivit√§ten/Freizeit</h2></div>
<div id="qol" class="section"><h2>Subskala Lebensqualit√§t</h2></div>

<button onclick="calculate()">‚úÖ Score berechnen</button>
<button onclick="downloadPDF()">üìÑ Als PDF speichern</button>
<div id="result"></div>

<hr style="margin:2rem 0;">

<div style="display:flex; justify-content:center; gap:1rem; margin-top:2rem;">
  <!-- Zur√ºck zur letzten Seite -->
  <button onclick="goBack()" style="
    padding: 10px 18px;
    border-radius: 8px;
    border: none;
    background-color: #f0f0f0;
    font-size: 1rem;
    cursor: pointer;
  ">
    ‚¨ÖÔ∏è Zur√ºck
  </button>

  <!-- Zur√ºck zur Hauptseite -->
  <button onclick="window.location.href='index.html'" style="
    padding: 10px 18px;
    border-radius: 8px;
    border: none;
    background-color: #d0eaff;
    font-size: 1rem;
    cursor: pointer;
  ">
    üè† Hauptseite
  </button>
</div>

<script>
function goBack() {
  if (document.referrer && document.referrer !== window.location.href) {
    history.back();
  } else {
    window.location.href = 'index.html';
  }
}
</script>


<script>
/* ===== Skalen ===== */
const SCALE_FREQ = ["nie","selten","manchmal","oft","immer"];
const SCALE_FREQ2 = ["nie","monatlich","w√∂chentlich","t√§glich","immer"];
const SCALE_DEG  = ["gar nicht","wenig","m√§√üig","stark","sehr stark"];
const SCALE_DIFF = ["keine","wenig","m√§√üige","gro√üe","sehr gro√üe"];
const SCALE_LIFE = ["gar nicht","wenig","m√§√üig","stark","sehr stark"];
const SCALE_AWARE= ["nie","monatlich","w√∂chentlich","t√§glich","immer"];

/* ===== Items ===== */
/* SYMPTOME ‚Äì Hinweis vor S4/S5 zur Steifigkeit */
const SYMPTOMS = [
  {id:"S1",text:"1. Sp√ºren Sie ein Reiben/Klicken/Knirschen/Knacken oder ein anderes Ger√§usch in der H√ºfte?",scale:SCALE_FREQ,values:[0,1,2,3,4]},
  {id:"S2",text:"2. Haben Sie Schwierigkeiten, die Beine zu spreizen?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"S3",text:"3. Haben Sie Schwierigkeiten, beim Gehen gro√üe Schritte zu machen?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  // Inline-Hinweis vor S4/S5:
  {type:"note", text:"Die folgenden Fragen betreffen die Steifigkeit im H√ºftgelenk, die Sie in der letzten Woche wahrgenommen haben. Steifigkeit ist ein Gef√ºhl von Einschr√§nkung oder Langsamkeit in den Bewegungen (‚Äûharzige Bewegungen‚Äú) des H√ºftgelenks."},
  {id:"S4",text:"4. Wie ausgepr√§gt ist die Steifigkeit in Ihrem H√ºftgelenk, wenn Sie morgens aufwachen?",scale:SCALE_DEG,values:[0,1,2,3,4]},
  {id:"S5",text:"5. Wie ausgepr√§gt ist die Steifigkeit in Ihrem H√ºftgelenk nach dem Sitzen, Liegen oder Ausruhen im Verlauf des Tages?",scale:SCALE_DEG,values:[0,1,2,3,4]},
];

/* SCHMERZ ‚Äì Hinweis vor P2‚ÄìP9 */
const PAIN = [
  {id:"P1",text:"1. Wie oft haben Sie Schmerzen in der H√ºfte?",scale:SCALE_FREQ2,values:[0,1,2,3,4]},
  {type:"note", text:"Wie starke Schmerzen versp√ºrten Sie in der H√ºfte in der letzten Woche w√§hrend der folgenden T√§tigkeiten:"},
  {id:"P2",text:"2. Vollst√§ndiges Strecken der H√ºfte (Aufrichten)?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"P3",text:"3. Maximales Beugen der H√ºfte?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"P4",text:"4. Gehen in unebenem Gel√§nde?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"P5",text:"5. Treppen hinauf- oder hinuntersteigen?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"P6",text:"6. Nachts im Bett?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"P7",text:"7. Sitzen oder Liegen?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"P8",text:"8. Aufrecht stehen?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"P9",text:"9. Gehen auf hartem Boden?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
];

/* ADL ‚Äì Abschnittsintro als Lead-Note */
const ADL = [
  {type:"lead", text:"Die nachfolgenden Fragen beziehen sich auf Ihre k√∂rperliche Leistungsf√§higkeit. Hierunter verstehen wir Ihre F√§higkeit, sich selbst√§ndig zu bewegen bzw. sich selbst zu versorgen. F√ºr jede der nachfolgenden Aktivit√§ten sollen Sie das Ausma√ü der Schwierigkeiten angeben, welche Sie durch Ihr H√ºftgelenk innerhalb der letzten Woche erfahren haben."},
];
[
 "Treppen hinuntersteigen","Treppen hinaufsteigen","Vom Sitzen aufstehen","Stehen",
 "Sich b√ºcken/einen Gegenstand vom Boden aufheben","Gehen in unebenem Gel√§nde",
 "Einsteigen in ein Auto/Aussteigen aus einem Auto","Einkaufen","Socken/Str√ºmpfe anziehen",
 "Vom Bett aufstehen","Socken/Str√ºmpfe ausziehen",
 "Im Bett liegen (Drehen mit Beibehalten der H√ºftposition)","Einsteigen in die Badewanne/Aussteigen aus der Badewanne",
 "Sitzen","Sich auf die Toilette hinsetzen und wieder aufstehen",
 "Schwere Hausarbeit verrichten (Kisten tragen, Boden wischen‚Ä¶)","Leichte Hausarbeit verrichten (Kochen, Staub wischen‚Ä¶)"
].forEach((t,i)=>ADL.push({id:`A${i+1}`,text:`${i+1}. ${t}?`,scale:SCALE_DIFF,values:[0,1,2,3,4]}));

/* SPORT/FREIZEIT ‚Äì Abschnittsintro als Lead-Note */
const SPORT = [
  {type:"lead", text:"Die folgenden Aktivit√§ten beziehen sich auf Ihre k√∂rperliche Funktion bei anspruchsvolleren T√§tigkeiten. Geben Sie bitte f√ºr jede der folgenden T√§tigkeiten an, wie gro√üe Schwierigkeiten Ihnen Ihre H√ºfte w√§hrend der letzten Woche bereitet hat."},
  {id:"SP1",text:"1. Kauern/in die Hocke gehen?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"SP2",text:"2. Rennen?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"SP3",text:"3. Drehen auf dem belasteten Bein?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
  {id:"SP4",text:"4. Gehen in unebenem Gel√§nde?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
];

/* QOL */
const QOL = [
  {id:"Q1",text:"1. Wie oft sind Sie sich Ihres H√ºftproblems bewusst?",scale:SCALE_AWARE,values:[0,1,2,3,4]},
  {id:"Q2",text:"2. Haben Sie Ihren Lebensstil ver√§ndert, um T√§tigkeiten zu vermeiden, die Ihrer H√ºfte schaden k√∂nnten?",scale:SCALE_LIFE,values:[0,1,2,3,4]},
  {id:"Q3",text:"3. Wie sehr belastet Sie Ihr fehlendes Vertrauen in Ihre H√ºfte?",scale:SCALE_LIFE,values:[0,1,2,3,4]},
  {id:"Q4",text:"4. Wie gro√ü sind die Schwierigkeiten, die Sie im Allgemeinen mit Ihrer H√ºfte haben?",scale:SCALE_DIFF,values:[0,1,2,3,4]},
];

/* ===== Rendering (unterst√ºtzt Notes/Lead-Notes) ===== */
function renderBlock(containerId, items){
  const wrap = document.getElementById(containerId);
  items.forEach(q=>{
    if(q.type === "lead" || q.type === "note"){
      const d = document.createElement("div");
      d.className = "section-note";
      d.textContent = q.text;
      wrap.appendChild(d);
      return;
    }
    const div = document.createElement("div");
    div.className = "qblock";
    const head = `<div class="qtitle">${q.text}</div>`;
    const labRow = `<tr><th>Antwort</th>${q.scale.map(l=>`<td>${l}</td>`).join("")}</tr>`;
    const inpRow = `<tr><th>Auswahl</th>${q.values.map(v=>`<td><input type="radio" name="${q.id}" value="${v}"></td>`).join("")}</tr>`;
    div.innerHTML = head + `<table class="grid">${labRow}${inpRow}</table>`;
    wrap.appendChild(div);
  });
}

renderBlock("symptoms", SYMPTOMS);
renderBlock("pain", PAIN);
renderBlock("adl", ADL);
renderBlock("sport", SPORT);
renderBlock("qol", QOL);

/* ===== Scoring ===== */
function val(id){ const el=document.querySelector(`input[name="${id}"]:checked`); return el?Number(el.value):0; }
function mean(arr){ return arr.reduce((a,b)=>a+b,0)/arr.length; }
function score(list){ return +(100 - mean(list.map(val))*25).toFixed(1); }

function calculate(){
  const Sym  = score(SYMPTOMS.filter(x=>x.id).map(q=>q.id));
  const Pain = score(PAIN.filter(x=>x.id).map(q=>q.id));
  const ADLs = score(ADL.filter(x=>x.id).map(q=>q.id));
  const Sprt = score(SPORT.filter(x=>x.id).map(q=>q.id));
  const Qol  = score(QOL.filter(x=>x.id).map(q=>q.id));
  const Total = +((Sym+Pain+ADLs+Sprt+Qol)/5).toFixed(1);

  window.hoosScores={Sym,Pain,ADLs,Sprt,Qol,Total};

  document.getElementById("result").textContent =
`HOOS Symptome: ${Sym} %
HOOS Schmerz: ${Pain} %
HOOS ADL: ${ADLs} %
HOOS Sport/Rec: ${Sprt} %
HOOS Lebensqualit√§t: ${Qol} %

HOOS Gesamt (Mittelwert): ${Total} %`;
}

/* ===== PDF (inkl. Lead-/Note-Texte & Datum) ===== */
function downloadPDF(){
  if(!window.hoosScores){ alert("Bitte zuerst Score berechnen."); return; }

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({unit:"mm", format:"a4"});
  if(window.robotoBase64){
    doc.addFileToVFS("Roboto-Regular.ttf",window.robotoBase64);
    doc.addFont("Roboto-Regular.ttf","Roboto","normal");
    doc.setFont("Roboto");
  }

  const today=new Date().toLocaleDateString("de-CH",{year:"numeric",month:"2-digit",day:"2-digit"});
  let y=20, left=15, lh=7;

  doc.setFontSize(16); doc.text("HOOS ‚Äì Auswertung",left,y); y+=lh;
  doc.setFontSize(11); doc.text(`Datum: ${today}`,left,y); y+=lh+2;

  function writeWrapped(text, fontSize=11, extra=0){
    doc.setFontSize(fontSize);
    const lines = doc.splitTextToSize(text, 180);
    lines.forEach(ln=>{ doc.text(ln,left,y); y+=lh; });
    y += extra;
    if(y>275){ doc.addPage(); y=20; }
  }

  function block(title, items){
    doc.setFontSize(13); doc.text(title,left,y); y+=lh;
    items.forEach(q=>{
      if(q.type==="lead" || q.type==="note"){
        writeWrapped(q.text, 11, 2);
        return;
      }
      doc.setFontSize(11);
      const lines = doc.splitTextToSize(q.text, 170);
      lines.forEach((ln,i)=>{
        doc.text(ln,left,y);
        if(i===0){
          const sel = document.querySelector(`input[name="${q.id}"]:checked`);
          const label = sel ? q.scale[q.values.indexOf(Number(sel.value))] : "-";
          doc.text(label, 195, y, {align:"right"});
        }
        y+=lh;
      });
      y+=2;
      if(y>275){ doc.addPage(); y=20; }
    });
    y+=3;
    if(y>275){ doc.addPage(); y=20; }
  }

  block("Subskala Symptome", SYMPTOMS);
  block("Subskala Schmerz",   PAIN);
  block("Subskala ADL",       ADL);
  block("Subskala Sport/Freizeit", SPORT);
  block("Subskala Lebensqualit√§t", QOL);

  if(y>260){ doc.addPage(); y=20; }
  doc.setFontSize(13); doc.text("Ergebnisse:",left,y); y+=lh;
  doc.setFontSize(11);
  doc.text(`HOOS Symptome: ${window.hoosScores.Sym} %`,left,y); y+=lh;
  doc.text(`HOOS Schmerz: ${window.hoosScores.Pain} %`,left,y); y+=lh;
  doc.text(`HOOS ADL: ${window.hoosScores.ADLs} %`,left,y); y+=lh;
  doc.text(`HOOS Sport/Rec: ${window.hoosScores.Sprt} %`,left,y); y+=lh;
  doc.text(`HOOS Lebensqualit√§t: ${window.hoosScores.Qol} %`,left,y); y+=lh+2;

  doc.setLineWidth(0.2); doc.line(left,y,195,y); y+=lh;
  doc.setFontSize(13); doc.text(`HOOS Gesamt (Mittelwert): ${window.hoosScores.Total} %`,left,y);

  doc.save("HOOS_Auswertung.pdf");
}

</script>

</body>
</html>
