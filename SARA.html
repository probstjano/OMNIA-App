<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DEMMI ‚Äì De Morton Mobility Index</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: sans-serif; margin: 10px; font-size: 16px; max-width: 600px; }
    label { display: block; margin: 10px 0 5px; }
    select {
      width: 100%;
      padding: 6px;
      font-size: 16px;
      margin-bottom: 10px;
    }
    button { padding: 10px 15px; font-size: 16px; margin-top: 10px; }
    #result { font-weight: bold; margin-top: 20px; }
    .nav-buttons { margin-top: 30px; }
    .nav-buttons a {
      display: inline-block;
      margin-right: 10px;
      padding: 10px 15px;
      background: #eee;
      border-radius: 8px;
      text-decoration: none;
      color: #000;
    }
    .nav-buttons a:hover { background: #ddd; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>SARA ‚Äì Scale for the Assessment and Rating of Ataxia</h1>
  <p> semiquantitativen Bewertung der Kleinhirnataxie (spinozerebell√§re, Friedreich- und sporadische Ataxxie. Kann auch bei Schlaganfallpatienten mit Ataxie verwendet werden. H√∂here Werte = st√§rkere Ataxie.</p>
  <p> Im Cenplex Beahndlungsplan als <strong> Messung </strong> hinterlegt . Hier durchf√ºhren und Score im Cenplex √ºbertragen </p>
  <p>Detailliertes Durchf√ºhrungsprotokoll hier:
    <a href="https://probstjano.github.io/OpenPdf/SARA_Protokoll.pdf" target="_blank" rel="noopener">SARA Protokoll (PDF)</a>
  </p>
  <form id="saraForm">
    <div id="questions"></div>
    <button type="button" onclick="calculateSARA()">‚úÖ Score berechnen</button>
    <button type="button" onclick="generatePDF()">üìÑ PDF erstellen</button>
  </form>
 
  
  <div id="result"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const questions = [
  {
    text: "1) Gang",
    options: [
      "0 ‚Äì Normal, keine Schwierigkeiten beim Gehen, beim Drehen und bei Tandemgang (bis zu einem Fehltritt erlaubt)",
      "1 ‚Äì Leichte Schwierigkeiten, nur sichtbar bei 10 aufeinanderfolgenden Schritten im Tandem",
      "2 ‚Äì Deutlich abnormal, mehr als 10 Schritte im Tandem nicht m√∂glich",
      "3 ‚Äì Erhebliches Schwanken, Schwierigkeiten bei der Halbumdrehung, aber ohne Unterst√ºtzung",
      "4 ‚Äì Ausgepr√§gtes Schwanken, gelegentliches Abst√ºtzen an der Wand erforderlich",
      "5 ‚Äì Starkes Schwanken, st√§ndige Unterst√ºtzung durch Stock oder Arm",
      "6 ‚Äì Gehen >10 m nur mit starker Unterst√ºtzung (zwei spezielle St√∂cke oder Rollator oder Begleitperson)",
      "7 ‚Äì Gehen <10 m nur mit starker Unterst√ºtzung (zwei spezielle St√∂cke oder Rollator oder Begleitperson)",
      "8 ‚Äì Gehunf√§hig, auch mit Unterst√ºtzung"
    ]
  },
  {
    text: "2) Stand",
    options: [
      "0 ‚Äì Normal, kann im Tandem >10 s stehen",
      "1 ‚Äì Stehen >10 s mit F√º√üen zusammen m√∂glich, aber nicht im Tandem",
      "2 ‚Äì Stehen >10 s mit F√º√üen zusammen, aber mit Schwankungen",
      "3 ‚Äì Stehen >10 s nur in nat√ºrlicher Position",
      "4 ‚Äì Kann in nat√ºrlicher Position f√ºr >10 s stehen, nur mit gelegentlicher Unterst√ºtzung",
      "5 ‚Äì Kann f√ºr >10 s in nat√ºrlicher Position nur mit st√§ndiger Unterst√ºtzung eines Armes stehen",
      "6 ‚Äì Nicht in der Lage f√ºr >10 s zu stehen, auch bei konstanter Abst√ºtzung eines Armes"
    ]
  },
  {
    text: "3) Sitzen",
    options: [
      "0 ‚Äì Normal, keine Schwierigkeiten beim Sitzen >10 s",
      "1 ‚Äì Leichte Schwierigkeiten, gelegentliches Schwanken",
      "2 ‚Äì St√§ndiges Schwanken, aber >10 s ohne Halten sitzen",
      "3 ‚Äì Nur mit gelegentlicher Unterst√ºtzung >10 s sitzen",
      "4 ‚Äì Ohne kontinuierliche Unterst√ºtzung nicht m√∂glich >10 s zu sitzen"
    ]
  },
  {
    text: "4) Sprechst√∂rungen",
    options: [
      "0 ‚Äì Normal",
      "1 ‚Äì Vermutung von Sprechst√∂rungen",
      "2 ‚Äì Das Sprechen ist gest√∂rt, aber es ist leicht die Person zu verstehen",
      "3 ‚Äì Gelegentlich sind W√∂rter schwer zu verstehen",
      "4 ‚Äì Viele W√∂rter sind schwer zu verstehen",
      "5 ‚Äì Nur einzelne W√∂rter sind verst√§ndlich",
      "6 ‚Äì Das Sprechen ist unverst√§ndlich/Dysarthrie"
    ]
  },
  {
    text: "5) Finger Chase",
    options: [
      "0 ‚Äì Keine Dysmetrie",
      "1 ‚Äì Dysmetrie <5 cm, zu kurz oder √ºber das Ziel hinausschie√üend",
      "2 ‚Äì Dysmetrie <15 cm, zu kurz oder √ºber das Ziel hinausschie√üend",
      "3 ‚Äì Dysmetrie >15 cm, zu kurz oder √ºber das Ziel hinausschie√üend",
      "4 ‚Äì Nicht in der Lage, 5 Bewegungen auszuf√ºhren"
    ]
  },
  {
    text: "6) Finger-Nase-Test",
    options: [
      "0 ‚Äì Kein Tremor",
      "1 ‚Äì Tremor mit einer Amplitude von <2 cm",
      "2 ‚Äì Tremor mit einer Amplitude von <5 cm",
      "3 ‚Äì Tremor mit einer Amplitude von >5 cm",
      "4 ‚Äì Nicht in der Lage, 5 Zeigebewegungen auszuf√ºhren"
    ]
  },
  {
    text: "7) Schnelle, alternierende Bewegungen der H√§nde",
    options: [
      "0 ‚Äì Normal, keine Unregelm√§√üigkeiten (unter 10 s)",
      "1 ‚Äì Geringe Unregelm√§√üigkeiten (unter 10 s)",
      "2 ‚Äì Deutliche Unregelm√§√üigkeit, Bewegungen schwer unterscheidbar oder unterbrochen, aber unter 10 s",
      "3 ‚Äì Sehr gro√üe Unregelm√§√üigkeit, schwer unterscheidbare Bewegungen oder Unterbrechungen, √ºber 10 s",
      "4 ‚Äì Nicht in der Lage, 10 Zyklen auszuf√ºhren"
    ]
  },
  {
    text: "8) Knie-Hacke-Versuch",
    options: [
      "0 ‚Äì Normal",
      "1 ‚Äì Geringf√ºgig abnormales Gleiten, Kontakt zum Schienbein wird gehalten",
      "2 ‚Äì Deutliches abnormales Gleiten, Ferse verliert bis zu 3-mal den Kontakt zum Schienbein w√§hrend 3 Zyklen",
      "3 ‚Äì Stark abnormales Gleiten, Ferse verliert mehr als 3-mal den Kontakt w√§hrend 3 Zyklen",
      "4 ‚Äì Nicht in der Lage, die Aufgabe auszuf√ºhren"
    ]
  }
];

    const container = document.getElementById("questions");
    questions.forEach((q, i) => {
      const block = document.createElement("div");
      block.className = "question-block";
      const options = q.options.map((text, idx) => `<option value="${idx}">${text}</option>`).join("");
      block.innerHTML = `
        <div class="question">${q.text}</div>
        <select name="q${i}" required>
          <option value="" disabled selected>Antwort ausw√§hlen</option>
          ${options}
        </select>
      `;
      container.appendChild(block);
    });

    function calculateSARA() {
      let total = 0;
      for (let i = 0; i < questions.length; i++) {
        const val = parseInt(document.querySelector(`select[name='q${i}']`)?.value);
        if (isNaN(val)) return alert("Bitte alle Fragen beantworten.");
        total += val;
      }
      document.getElementById("result").innerText = `SARA Gesamtscore: ${total} / 40\n(H√∂here Werte = st√§rkere Ataxie)`;
    }

    async function generatePDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  // ‚úÖ Falls Roboto eingebunden ist
  if (window.robotoBase64) {
    doc.addFileToVFS("Roboto-Regular.ttf", window.robotoBase64);
    doc.addFont("Roboto-Regular.ttf", "Roboto", "normal");
    doc.setFont("Roboto", "normal");
  }

  const left = 15;
  const right = 190;
  let y = 20;
  const lineHeight = 8;

  doc.setFontSize(16);
  doc.text("SARA ‚Äì Scale for the Assessment and Rating of Ataxia", left, y);
  y += lineHeight;

  doc.setFontSize(12);
  doc.line(left, y, right, y); y += 5;

  let total = 0;

  for (let i = 0; i < questions.length; i++) {
    const q = questions[i];
    const select = document.querySelector(`select[name='q${i}']`);
    const val = parseInt(select?.value);
    const label = select?.options[select.selectedIndex]?.text || "-";

    if (!isNaN(val)) total += val;

    const lines = doc.splitTextToSize(`${q.text}`, 160);
    lines.forEach((line, idx) => {
      doc.text(line, left, y);
      if (idx === 0) doc.text(`Antwort:`, right, y, { align: "right" });
      y += lineHeight;
    });

    doc.setFontSize(11);
    doc.text(`${label}`, left + 5, y); y += lineHeight;

    if (y > 270) {
      doc.addPage();
      y = 20;
    }
    doc.setFontSize(12);
  }

  y += 5;
  doc.setFontSize(14);
  doc.text(`Gesamtscore: ${total} / 40 (h√∂here Werte = st√§rkere Ataxie)`, left, y);
  y += lineHeight;

  const today = new Date().toLocaleDateString("de-CH");
  doc.setFontSize(12);
  doc.text(`Datum: ${today}`, left, y);

  doc.save("SARA_Auswertung.pdf");
}

  </script>
<p></p><div style="display:flex; justify-content:center; gap:1rem; margin-top:2rem;">
  <!-- Zur√ºck zur letzten Seite -->
  <button onclick="goBack()" style="
    padding: 10px 18px;
    border-radius: 8px;
    border: none;
    background-color: #f0f0f0;
    font-size: 1rem;
    cursor: pointer;
  ">
    ‚¨ÖÔ∏è Zur√ºck
  </button>

  <!-- Zur√ºck zur Hauptseite -->
  <button onclick="window.location.href='index.html'" style="
    padding: 10px 18px;
    border-radius: 8px;
    border: none;
    background-color: #d0eaff;
    font-size: 1rem;
    cursor: pointer;
  ">
    üè† Hauptseite
  </button>
</div>

<script>
function goBack() {
  if (document.referrer && document.referrer !== window.location.href) {
    history.back();
  } else {
    window.location.href = 'index.html';
  }
}
</script>
</body>
</html>
