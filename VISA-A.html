<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VISA-A</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="robotoBase64.js"></script>

  <style>
    body { font-family: sans-serif; margin: 2rem; font-size: 16px; max-width: 920px; }
    h1 { margin-bottom: .25rem; }
    .subtitle { color: #333; margin-bottom: 1rem; }
    .intro { margin: .8rem 0 1.3rem; }
    .qblock { margin: 1.2rem 0 1.4rem; }
    .qtitle { font-weight: 700; margin-bottom: .55rem; }

    /* Schmerz-Pfeil deutlicher */
    .pain-scale {
      margin: .6rem 0 .9rem;
      display: flex;
      justify-content: space-between;
      font-size: 1.08rem;
      font-weight: 600;
    }

    .grid { width: 100%; border-collapse: collapse; margin-top: .25rem; }
    .grid th, .grid td { padding: .45rem .5rem; border: 1px solid #ccc; text-align: center; }
    .grid th:first-child, .grid td:first-child { text-align: left; }

    .opts-row { display:flex; flex-direction:column; gap:.5rem; margin-top:.5rem; }

    .q8group { padding:1rem; border:1px solid #bbb; border-radius:6px; background:#fafafa; margin-top:1.6rem; }

    button { padding: 10px 15px; margin-top:18px; font-size:16px; cursor:pointer; }

    #result { margin-top: 20px; font-weight:700; white-space: pre-line; }

  </style>
</head>

<body>
  <h1>VISA-A</h1>
  <div class="subtitle">validierte deutsche Version (Lohrer et al. 2011)</div>

  <p class="intro">
    Der folgende Fragebogen dient der Erfassung von Beschwerden und Problemen, die durch Ihre Achillessehne verursacht werden.
    <br>Kreuzen Sie für jede Frage dasjenige Kästchen an, das Ihr derzeitiges Befinden wiedergibt.
  </p>

  <form id="form">

    <!-- 1 -->
    <div class="qblock">
      <div class="qtitle">1. Für wie viele Minuten verspüren Sie nach dem ersten Aufstehen ein Steifigkeitsgefühl in der Achillessehnenregion?</div>
      <table class="grid">
        <tr><th>Minuten</th><td>100</td><td>90</td><td>80</td><td>70</td><td>60</td><td>50</td><td>40</td><td>30</td><td>20</td><td>10</td><td>0</td></tr>
        <tr><th>Punkte</th>
          <td><input type="radio" name="q1" value="0"></td><td><input type="radio" name="q1" value="1"></td><td><input type="radio" name="q1" value="2"></td><td><input type="radio" name="q1" value="3"></td><td><input type="radio" name="q1" value="4"></td><td><input type="radio" name="q1" value="5"></td><td><input type="radio" name="q1" value="6"></td><td><input type="radio" name="q1" value="7"></td><td><input type="radio" name="q1" value="8"></td><td><input type="radio" name="q1" value="9"></td><td><input type="radio" name="q1" value="10"></td>
        </tr>
      </table>
    </div>

    <!-- 2 -->
    <div class="qblock">
      <div class="qtitle">2. Nachdem Sie für den Tag aufgewärmt sind, haben Sie Schmerzen, wenn Sie die Achillessehne über der Kante einer Treppe dehnen (Knie gestreckt halten)?</div>
      <div class="pain-scale"><strong>Starker heftiger Schmerz</strong> ←──────────→ <strong>Kein Schmerz</strong></div>
      <table class="grid">
        <tr><th>Punkte</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr>
        <tr><th></th>
          <td><input type="radio" name="q2" value="0"></td><td><input type="radio" name="q2" value="1"></td><td><input type="radio" name="q2" value="2"></td><td><input type="radio" name="q2" value="3"></td><td><input type="radio" name="q2" value="4"></td><td><input type="radio" name="q2" value="5"></td><td><input type="radio" name="q2" value="6"></td><td><input type="radio" name="q2" value="7"></td><td><input type="radio" name="q2" value="8"></td><td><input type="radio" name="q2" value="9"></td><td><input type="radio" name="q2" value="10"></td>
        </tr>
      </table>
    </div>

    <!-- 3 -->
    <div class="qblock">
      <div class="qtitle">3. Nachdem Sie 30 Minuten auf unebenem Untergrund gegangen sind, haben Sie in den darauffolgenden 2 Stunden Schmerzen?</div>
      <div class="pain-scale"><strong>Starker heftiger Schmerz</strong> ←──────────→ <strong>Kein Schmerz</strong></div>
      <table class="grid">
        <tr><th>Punkte</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr>
        <tr><th></th>
          <td><input type="radio" name="q3" value="0"></td><td><input type="radio" name="q3" value="1"></td><td><input type="radio" name="q3" value="2"></td><td><input type="radio" name="q3" value="3"></td><td><input type="radio" name="q3" value="4"></td><td><input type="radio" name="q3" value="5"></td><td><input type="radio" name="q3" value="6"></td><td><input type="radio" name="q3" value="7"></td><td><input type="radio" name="q3" value="8"></td><td><input type="radio" name="q3" value="9"></td><td><input type="radio" name="q3" value="10"></td>
        </tr>
      </table>
    </div>

    <!-- 4 -->
    <div class="qblock">
      <div class="qtitle">4. Haben Sie Schmerzen, wenn Sie mit normaler Geschwindigkeit die Treppe heruntergehen?</div>
      <div class="pain-scale"><strong>Starker heftiger Schmerz</strong> ←──────────→ <strong>Kein Schmerz</strong></div>
      <table class="grid">
        <tr><th>Punkte</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr>
        <tr><th></th>
          <td><input type="radio" name="q4" value="0"></td><td><input type="radio" name="q4" value="1"></td><td><input type="radio" name="q4" value="2"></td><td><input type="radio" name="q4" value="3"></td><td><input type="radio" name="q4" value="4"></td><td><input type="radio" name="q4" value="5"></td><td><input type="radio" name="q4" value="6"></td><td><input type="radio" name="q4" value="7"></td><td><input type="radio" name="q4" value="8"></td><td><input type="radio" name="q4" value="9"></td><td><input type="radio" name="q4" value="10"></td>
        </tr>
      </table>
    </div>

    <!-- 5 -->
    <div class="qblock">
      <div class="qtitle">5. Haben Sie Schmerzen, während oder unmittelbar nachdem Sie 10 (einbeinige) Zehenstände ausgeführt haben?</div>
      <div class="pain-scale"><strong>Starker heftiger Schmerz</strong> ←──────────→ <strong>Kein Schmerz</strong></div>
      <table class="grid">
        <tr><th>Punkte</th><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr>
        <tr><th></th>
          <td><input type="radio" name="q5" value="0"></td><td><input type="radio" name="q5" value="1"></td><td><input type="radio" name="q5" value="2"></td><td><input type="radio" name="q5" value="3"></td><td><input type="radio" name="q5" value="4"></td><td><input type="radio" name="q5" value="5"></td><td><input type="radio" name="q5" value="6"></td><td><input type="radio" name="q5" value="7"></td><td><input type="radio" name="q5" value="8"></td><td><input type="radio" name="q5" value="9"></td><td><input type="radio" name="q5" value="10"></td>
        </tr>
      </table>
    </div>

    <!-- 6 -->
    <div class="qblock">
      <div class="qtitle">6. Wie oft können Sie ohne Schmerzen auf einem Bein hüpfen?</div>
      <table class="grid">
        <tr><th>Sprünge</th><td>0x</td><td>1x</td><td>2x</td><td>3x</td><td>4x</td><td>5x</td><td>6x</td><td>7x</td><td>8x</td><td>9x</td><td>10x</td></tr>
        <tr><th>Punkte</th>
          <td><input type="radio" name="q6" value="0"></td><td><input type="radio" name="q6" value="1"></td><td><input type="radio" name="q6" value="2"></td><td><input type="radio" name="q6" value="3"></td><td><input type="radio" name="q6" value="4"></td><td><input type="radio" name="q6" value="5"></td><td><input type="radio" name="q6" value="6"></td><td><input type="radio" name="q6" value="7"></td><td><input type="radio" name="q6" value="8"></td><td><input type="radio" name="q6" value="9"></td><td><input type="radio" name="q6" value="10"></td>
        </tr>
      </table>
    </div>

    <!-- 7 -->
    <div class="qblock">
      <div class="qtitle">7. Üben Sie derzeit Sport oder andere körperliche Aktivitäten aus?</div>
      <div class="opts-row">
        <label><input type="radio" name="q7" value="0"> Nein, gar nicht; wegen der Symptome (0)</label>
        <label><input type="radio" name="q7" value="4"> Verändertes Trainings-/Wettkampfverhalten (4)</label>
        <label><input type="radio" name="q7" value="7"> Volle Belastung, aber niedrigeres Niveau (7)</label>
        <label><input type="radio" name="q7" value="10"> Voll belastbar / wie vorher oder höher (10)</label>
      </div>
    </div>

    <!-- 8 -->
    <div class="q8group">
      <div class="qtitle">8. Beantworten Sie entweder A, B oder C. Wenn Sie bei der Durchführung achillessehnenbelastender Sportarten keine Schmerzen empfinden, füllen Sie bitte nur Frage 8a aus. Wenn Sie bei der Durchführung achillessehnenbelastender Sportarten Schmerzen empfinden,
die Sie aber nicht zum Belastungsabbruch der Aktivität zwingen, füllen Sie bitte nur Frage 8b
aus. Wenn Sie bei der Durchführung achillessehnenbelastender Sportarten Schmerzen empfinden,
die Sie zum Abbruch der Aktivität zwingen, füllen Sie bitte nur Frage 8c aus.</div>

      <div class="qblock">
        <strong>8a. Keine Schmerzen</strong>
        <table class="grid">
          <tr><th>Minuten</th><td>0</td><td>1–10</td><td>11–20</td><td>21–30</td><td>&gt;30</td></tr>
          <tr><th>Punkte</th>
            <td><input type="radio" name="q8a" value="0"></td><td><input type="radio" name="q8a" value="7"></td><td><input type="radio" name="q8a" value="14"></td><td><input type="radio" name="q8a" value="21"></td><td><input type="radio" name="q8a" value="30"></td>
          </tr>
        </table>
      </div>

      <div class="qblock">
        <strong>8b. Schmerzen, aber kein Abbruch</strong>
        <table class="grid">
          <tr><th>Minuten</th><td>0</td><td>1–10</td><td>11–20</td><td>21–30</td><td>&gt;30</td></tr>
          <tr><th>Punkte</th>
            <td><input type="radio" name="q8b" value="0"></td><td><input type="radio" name="q8b" value="4"></td><td><input type="radio" name="q8b" value="10"></td><td><input type="radio" name="q8b" value="14"></td><td><input type="radio" name="q8b" value="20"></td>
          </tr>
        </table>
      </div>

      <div class="qblock">
        <strong>8c. Schmerzen → Abbruch</strong>
        <table class="grid">
          <tr><th>Minuten</th><td>0</td><td>1–10</td><td>11–20</td><td>21–30</td><td>&gt;30</td></tr>
          <tr><th>Punkte</th>
            <td><input type="radio" name="q8c" value="0"></td><td><input type="radio" name="q8c" value="2"></td><td><input type="radio" name="q8c" value="5"></td><td><input type="radio" name="q8c" value="7"></td><td><input type="radio" name="q8c" value="10"></td>
          </tr>
        </table>
      </div>
    </div>

  </form>

  <button onclick="calculate()">✅ Score berechnen</button>
  <button onclick="downloadPDF()">📄 Als PDF speichern</button>

  <div id="result"></div>

  <div style="display:flex; justify-content:center; gap:1rem; margin-top:2rem;">
    <button onclick="goBack()">⬅️ Zurück</button>
    <button onclick="window.location.href='index.html'">🏠 Hauptseite</button>
  </div>

<script>
let totalScore = null;

function getVal(name){
  const el=document.querySelector(`input[name="${name}"]:checked`);
  return el ? Number(el.value) : 0;
}

function calculate(){
  const s1=getVal("q1"), s2=getVal("q2"), s3=getVal("q3"), s4=getVal("q4"),
        s5=getVal("q5"), s6=getVal("q6"), s7=getVal("q7");

  const a=getVal("q8a"), b=getVal("q8b"), c=getVal("q8c");
  const s8=Math.max(a,b,c);

  const sum=s1+s2+s3+s4+s5+s6+s7+s8;
  totalScore=sum;
  document.getElementById("result").textContent =
    `Gesamtpunktzahl: ${sum}/100\nProzentwert: ${((sum/100)*100).toFixed(1)} %`;
}

function downloadPDF(){
  if(totalScore===null){ alert("Bitte zuerst Score berechnen."); return; }
  const { jsPDF } = window.jspdf;
  const doc=new jsPDF();

  if(window.robotoBase64){
    doc.addFileToVFS("Roboto-Regular.ttf", window.robotoBase64);
    doc.addFont("Roboto-Regular.ttf","Roboto","normal");
    doc.setFont("Roboto");
  }

  doc.setFontSize(16);
  doc.text("VISA-A – Auswertung", 15, 20);
  doc.setFontSize(12);
  doc.text(`Gesamtpunktzahl: ${totalScore}/100`, 15, 35);
  doc.text(`Prozentwert: ${((totalScore/100)*100).toFixed(1)} %`, 15, 43);

  doc.save("VISA-A_Auswertung.pdf");
}

function goBack(){
  if(document.referrer && document.referrer!==window.location.href){ history.back(); }
  else { window.location.href='index.html'; }
}

/* 8a/8b/8c exklusiv */
function setupExclusiveQ8(){
  const g={
    a:document.querySelectorAll('input[name="q8a"]'),
    b:document.querySelectorAll('input[name="q8b"]'),
    c:document.querySelectorAll('input[name="q8c"]')
  };
  function clear(x){ x.forEach(i=>i.checked=false); }

  g.a.forEach(i=>i.addEventListener("change",()=>{clear(g.b);clear(g.c);} ));
  g.b.forEach(i=>i.addEventListener("change",()=>{clear(g.a);clear(g.c);} ));
  g.c.forEach(i=>i.addEventListener("change",()=>{clear(g.a);clear(g.b);} ));
}

document.addEventListener("DOMContentLoaded", setupExclusiveQ8);
</script>

</body>
</html>
