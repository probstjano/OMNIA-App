<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>STarT Back Screening Tool</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="robotoBase64.js"></script>

  <style>
    body {
      font-family: sans-serif;
      margin: 2rem;
      font-size: 16px;
      max-width: 900px;
    }

    h1 { margin-bottom: .25rem; }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1.2rem;
    }

    th, td {
      border: 1px solid #ccc;
      padding: .55rem .6rem;
      vertical-align: middle;
    }

    th {
      background: #f0f0f0;
      text-align: center;
      font-weight: 700;
    }

    td:first-child {
      width: 70%;
      text-align: left;
    }

    #result {
      margin-top: 20px;
      font-weight: 700;
      white-space: pre-line;
    }

    .footer-nav {
      margin-top: 2rem;
      display: flex;
      gap: 1rem;
      justify-content: center;
    }

    button {
      padding: 10px 15px;
      margin-top: 18px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>

<body>

<h1>STarT Back Screening Tool</h1>

<form id="sbtform">

<table>
  <tr>
    <th>Frage / Antwort</th>
    <th>Nein (0)</th>
    <th>Ja (1)</th>
  </tr>

  <tr>
    <td>1. Mein Schmerz hat w√§hrend der letzten 2 Wochen zeitweise in die Beine ausgestrahlt.</td>
    <td><input type="radio" name="q1" value="0"></td>
    <td><input type="radio" name="q1" value="1"></td>
  </tr>

  <tr>
    <td>2. Zus√§tzlich zum Hauptschmerz hatte ich in den letzten 2 Wochen auch noch an anderen Stellen des R√ºckens Schmerzen.</td>
    <td><input type="radio" name="q2" value="0"></td>
    <td><input type="radio" name="q2" value="1"></td>
  </tr>

  <tr>
    <td>3. In den letzten 2 Wochen bin ich wegen meiner Schmerzen nur kurze Strecken gegangen.</td>
    <td><input type="radio" name="q3" value="0"></td>
    <td><input type="radio" name="q3" value="1"></td>
  </tr>

  <tr>
    <td>4. In den letzten 2 Wochen habe ich mich wegen meiner Schmerzen langsamer als gew√∂hnlich angezogen.</td>
    <td><input type="radio" name="q4" value="0"></td>
    <td><input type="radio" name="q4" value="1"></td>
  </tr>

  <tr>
    <td>5. K√∂rperliche Aktivit√§ten sind f√ºr Menschen in meinem Zustand eventuell gef√§hrlich.</td>
    <td><input type="radio" name="q5" value="0"></td>
    <td><input type="radio" name="q5" value="1"></td>
  </tr>

  <tr>
    <td>6. In den letzten 2 Wochen hatte ich viele Sorgen.</td>
    <td><input type="radio" name="q6" value="0"></td>
    <td><input type="radio" name="q6" value="1"></td>
  </tr>

  <tr>
    <td>7. Mein Schmerz ist sehr schlimm und ich habe das Gef√ºhl, dass er sich wahrscheinlich nie mehr bessern wird.</td>
    <td><input type="radio" name="q7" value="0"></td>
    <td><input type="radio" name="q7" value="1"></td>
  </tr>

  <tr>
    <td>8. In den letzten 2 Wochen hatte ich ganz allgemein nicht mehr so viel Freude an den Dingen, die mir sonst Freude bereiten.</td>
    <td><input type="radio" name="q8" value="0"></td>
    <td><input type="radio" name="q8" value="1"></td>
  </tr>

  <!-- FRAGE 9 ‚Äì 5-spaltige Skala wie im PDF -->

  <tr>
    <td>9. Wie st√∂rend war Ihr Schmerz in den letzten 2 Wochen?</td>
    <td colspan="2">
      <table style="width:100%; border-collapse:collapse;">
        <tr>
          <th>√ºberhaupt nicht (0)</th>
          <th>ein wenig (0)</th>
          <th>m√§√üig (0)</th>
          <th>sehr (1)</th>
          <th>extrem (1)</th>
        </tr>
        <tr>
          <td><input type="radio" name="q9" value="0"></td>
          <td><input type="radio" name="q9" value="0"></td>
          <td><input type="radio" name="q9" value="0"></td>
          <td><input type="radio" name="q9" value="1"></td>
          <td><input type="radio" name="q9" value="1"></td>
        </tr>
      </table>
    </td>
  </tr>

</table>
</form>

<button onclick="calc()">Score berechnen</button>
<button onclick="pdf()">PDF erstellen</button>

<div id="result"></div>

<script>
function calc(){
  let total = 0;
  let psycho = 0;

  for(let i=1;i<=9;i++){
    const el = document.querySelector(`input[name="q${i}"]:checked`);
    if(!el){
      document.getElementById("result").textContent = "Bitte alle Fragen beantworten.";
      return;
    }
    const v = Number(el.value);
    total += v;
    if(i>=5) psycho += v;
  }

  document.getElementById("result").textContent =
    `Gesamtpunktzahl: ${total}\nTeilsumme (Fragen 5‚Äì9): ${psycho}`;
}

function pdf(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  if(window.robotoBase64){
    doc.addFileToVFS("Roboto-Regular.ttf", window.robotoBase64);
    doc.addFont("Roboto-Regular.ttf","Roboto","normal");
    doc.setFont("Roboto");
  }

  doc.setFontSize(16);
  doc.text("STarT Back Screening Tool ‚Äì Auswertung", 15, 15);
  doc.setFontSize(12);

  const lines = document.getElementById("result").innerText.split("\n");
  let y = 30;
  lines.forEach(line => { doc.text(line,15,y); y+=8; });

  doc.save("StartBack.pdf");
}
</script>

<div class="footer-nav">
  <button onclick="goBack()">‚¨ÖÔ∏è Zur√ºck</button>
  <button onclick="goHome()">üè† Hauptseite</button>
</div>

<script src="app-core.js"></script>

</body>
</html>
