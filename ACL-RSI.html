<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ACL-RSI ‚Äì Return to Sports</title>

  <link rel="stylesheet" href="app-style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="robotoBase64.js"></script>

  <style>
    .question-block {
      margin-bottom: 28px;
      border-bottom: 1px solid #ccc;
      padding-bottom: 16px;
    }
    .scale-row {
      display: flex;
      justify-content: space-between;
      margin: 12px 0 4px 0;
      flex-wrap: wrap;
    }
    .scale-row label {
      text-align: center;
      margin: 2px;
      font-size: 14px;
    }
    .scale-labels {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      font-weight: bold;
      margin-top: 6px;
    }
  </style>
</head>

<body class="assessment-page">

<h1>ACL-RSI ‚Äì Return to Sports</h1>

  <p> Die Skala "Anterior Cruciate Ligament-Return to Sport after Injury" (ACL-RSI) wurde entwickelt, um die psychologische Bereitschaft zur R√ºckkehr in den Sport zu bewerten, 
    und hat psychologische Aspekte identifiziert, f√ºr die Patienten parallel zur physischen Rehabilitation eine Beratung ben√∂tigen, 
    um ihre Chancen auf eine erfolgreiche R√ºckkehr zum Sport zu erh√∂hen. </p>
  

<p>
Instruktion f√ºr Patient:innen: Dieser Fragebogen dient der Erfassung von Beschwerden und Problemen, die durch Ihr Kniegelenk verursacht werden.
Bitte beantworten Sie jede Frage entsprechend Ihrem aktuellen Befinden.
</p>

<p><strong>Hauptsportart:</strong></p>
<input type="text" style="width:100%;">

<form id="aclForm">

<script>
const qData = [
  { q:"1. Sind Sie zuversichtlich, dass Sie den Sport auf demselben Niveau wie vorher aus√ºben k√∂nnen?",
    L:"√úberhaupt nicht zuversichtlich", R:"v√∂llig zuversichtlich" },

  { q:"2. Halten Sie es f√ºr wahrscheinlich, Ihr Knie durch die Teilnahme an Ihrem Sport wieder verletzen zu k√∂nnen?",
    L:"Sehr wahrscheinlich", R:"v√∂llig unwahrscheinlich" },

  { q:"3. Macht Sie der Gedanke an die Aus√ºbung Ihres Sports nerv√∂s?",
    L:"Sehr nerv√∂s", R:"gar nicht nerv√∂s" },

  { q:"4. Sind Sie zuversichtlich, dass Ihr Knie bei der Aus√ºbung Ihres Sports nicht nachgeben wird?",
    L:"√úberhaupt nicht zuversichtlich", R:"v√∂llig zuversichtlich" },

  { q:"5. Sind Sie zuversichtlich, dass Sie Ihren Sport aus√ºben k√∂nnen, ohne Bedenken wegen Ihres Knies zu haben?",
    L:"√úberhaupt nicht zuversichtlich", R:"v√∂llig zuversichtlich" },

  { q:"6. Finden Sie es frustrierend, dass Sie in Bezug auf Ihren Sport Ihr Knie ber√ºcksichtigen m√ºssen?",
    L:"Sehr frustrierend", R:"√úberhaupt nicht frustrierend" },

  { q:"7. Bef√ºrchten Sie, dass Sie Ihr Knie bei der Aus√ºbung Ihres Sports wieder verletzen k√∂nnten?",
    L:"Habe gro√üe Sorge", R:"Habe √ºberhaupt keine Sorge" },

  { q:"8. Sind Sie zuversichtlich, dass Ihr Knie unter Belastung standh√§lt?",
    L:"√úberhaupt nicht zuversichtlich", R:"v√∂llig zuversichtlich" },

  { q:"9. Haben Sie Angst, dass Sie Ihr Knie bei der Aus√ºbung Ihres Sports versehentlich wieder verletzen k√∂nnten?",
    L:"Habe gro√üe Angst", R:"Habe √ºberhaupt keine Angst" },

  { q:"10. H√§lt Sie der Gedanke daran, nochmals operiert und nachbehandelt werden zu m√ºssen, davon ab, Ihren Sport auszu√ºben?",
    L:"Die ganze Zeit", R:"Zu keinem Zeitpunkt" },

  { q:"11. Sind Sie zuversichtlich, Ihren Sport gut aus√ºben zu k√∂nnen?",
    L:"√úberhaupt nicht zuversichtlich", R:"v√∂llig zuversichtlich" },

  { q:"12. Sind Sie gelassen, wenn es um die Aus√ºbung Ihres Sports geht?",
    L:"Gar nicht gelassen", R:"v√∂llig gelassen" }
];

const values = [0,10,20,30,40,50,60,70,80,90,100];

let html = "";
for(let i=0;i<qData.length;i++){
  const qn = i+1;
  html += `
    <div class="question-block">
      <p><strong>${qData[i].q}</strong></p>

      <div class="scale-row">
        ${values.map(v =>
          `<label>${v}<br><input type="radio" name="q${qn}" value="${v}"></label>`
        ).join("")}
      </div>

      <div class="scale-labels">
        <span>${qData[i].L}</span>
        <span>‚Üî</span>
        <span>${qData[i].R}</span>
      </div>
    </div>
  `;
}

document.write(html);
</script>

</form>

<button type="button" class="primary" onclick="calcACL()">‚úÖ Score berechnen</button>
<button type="button" class="secondary" onclick="pdfACL()">üìÑ PDF erstellen</button>

<div id="result" style="margin-top:20px;"></div>

<!-- ============================================================= -->
<!-- ==================== SCORE + PDF ============================ -->
<!-- ============================================================= -->

<script>
function calcACL() {
  let sum = 0;
  let answered = 0;

  for (let i = 1; i <= 12; i++) {
    const el = document.querySelector(`input[name='q${i}']:checked`);
    if (el) { sum += parseInt(el.value); answered++; }
  }

  if (answered !== 12) {
    document.getElementById("result").innerHTML = "<p>Bitte alle 12 Fragen beantworten.</p>";
    return;
  }

  const score = ((sum / 1200) * 100).toFixed(1);

  document.getElementById("result").innerHTML =
    `<p><strong>ACL-RSI-Score:</strong> ${score} %</p>
     <p>(( ${sum} ) erreichte Punkte) / ((1200) maximale Punkte) √ó 100 = ${score} %</p>`;
}

function pdfACL() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.addFileToVFS("Roboto-Regular.ttf", window.robotoBase64);
  doc.addFont("Roboto-Regular.ttf", "Roboto", "normal");
  doc.setFont("Roboto", "normal");
  let y = 15;

  doc.setFontSize(16);
  doc.text("ACL-RSI ‚Äì Return to Sports", 15, y);
  y += 12;

  doc.setFontSize(12);

  for (let i = 0; i < qData.length; i++) {
    const qn = i+1;
    const el = document.querySelector(`input[name='q${qn}']:checked`);
    const val = el ? el.value : "-";
    doc.text(`${qData[i].q}`, 15, y); y += 7;
    doc.text(`Wert: ${val}`, 15, y); y += 10;
    if (y > 270) { doc.addPage(); y = 20; }
  }

  y += 4;
  const lines = document.getElementById("result").innerText.split("\n");
  lines.forEach(line => { doc.text(line, 15, y); y += 7; });

  doc.save("ACL-RSI.pdf");
}
</script>

<!-- ====================== FOOTER ====================== -->

<div class="footer-nav">
  <button class="secondary" onclick="goBack()">‚¨ÖÔ∏è Zur√ºck</button>
  <button class="primary" onclick="goHome()">üè† Hauptseite</button>
</div>

<script src="app-core.js"></script>

</body>
</html>
