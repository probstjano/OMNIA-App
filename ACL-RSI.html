<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ACL-RSI</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="robotoBase64.js"></script>

  <style>
    body {
      font-family: sans-serif;
      margin: 2rem;
      font-size: 16px;
      max-width: 920px;
    }
    h1 { margin-bottom: .25rem; }
    .intro { margin: .8rem 0 1.4rem; }

    .qblock {
      margin: 1.4rem 0 1.8rem;
      padding-bottom: .4rem;
      border-bottom: 1px solid #ccc;
    }

    .qtitle {
      font-weight: 700;
      margin-bottom: .55rem;
    }

    /* Skalenbox wie VISA-A Tabellen */
    .box {
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 0.8rem;
      background: #fafafa;
      margin-top: .7rem;
    }

    table.scale {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: .4rem;
    }

    table.scale th,
    table.scale td {
      padding: .45rem .5rem;
      border: 1px solid #ccc;
      text-align: center;
      font-size: 15px;
    }

    .scale-labels {
      display: flex;
      justify-content: space-between;
      font-weight: 600;
      margin-top: .3rem;
      margin-bottom: .3rem;
      padding: 0 .2rem;
      font-size: 15px;
    }

    button {
      padding: 10px 15px;
      margin-top: 18px;
      font-size: 16px;
      cursor: pointer;
    }

    #result {
      margin-top: 20px;
      font-weight: 700;
      white-space: pre-line;
    }

    .footer-nav {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 2rem;
    }
  </style>
</head>

<body>

<h1>ACL-RSI</h1>

<p class="intro">
Dieser Fragebogen dient der Erfassung von Beschwerden und Problemen, die durch Ihr Knie verursacht werden.
Beantworten Sie jede Frage entsprechend Ihrem aktuellen Befinden.
</p>

<p><strong>Hauptsportart:</strong></p>
<input type="text" style="width:100%; margin-bottom:1rem;">

<form id="aclform">

<!-- ---------------------- QUESTIONS ---------------------- -->

<script>
const q = [
  ["1. Sind Sie zuversichtlich, dass Sie den Sport auf demselben Niveau wie vorher aus√ºben k√∂nnen?",
    "√úberhaupt nicht zuversichtlich", "v√∂llig zuversichtlich"],

  ["2. Halten Sie es f√ºr wahrscheinlich, Ihr Knie durch die Teilnahme an Ihrem Sport wieder verletzen zu k√∂nnen?",
    "Sehr wahrscheinlich", "v√∂llig unwahrscheinlich"],

  ["3. Macht Sie der Gedanke an die Aus√ºbung Ihres Sports nerv√∂s?",
    "Sehr nerv√∂s", "gar nicht nerv√∂s"],

  ["4. Sind Sie zuversichtlich, dass Ihr Knie bei der Aus√ºbung Ihres Sports nicht nachgeben wird?",
    "√úberhaupt nicht zuversichtlich", "v√∂llig zuversichtlich"],

  ["5. Sind Sie zuversichtlich, dass Sie Ihren Sport aus√ºben k√∂nnen, ohne Bedenken wegen Ihres Knies zu haben?",
    "√úberhaupt nicht zuversichtlich", "v√∂llig zuversichtlich"],

  ["6. Finden Sie es frustrierend, dass Sie in Bezug auf Ihren Sport Ihr Knie ber√ºcksichtigen m√ºssen?",
    "Sehr frustrierend", "√úberhaupt nicht frustrierend"],

  ["7. Bef√ºrchten Sie, dass Sie Ihr Knie bei der Aus√ºbung Ihres Sports wieder verletzen k√∂nnten?",
    "Habe gro√üe Sorge", "Habe √ºberhaupt keine Sorge"],

  ["8. Sind Sie zuversichtlich, dass Ihr Knie unter Belastung standh√§lt?",
    "√úberhaupt nicht zuversichtlich", "v√∂llig zuversichtlich"],

  ["9. Haben Sie Angst, dass Sie Ihr Knie bei der Aus√ºbung Ihres Sports versehentlich wieder verletzen k√∂nnten?",
    "Habe gro√üe Angst", "Habe √ºberhaupt keine Angst"],

  ["10. H√§lt Sie der Gedanke daran, nochmals operiert und nachbehandelt werden zu m√ºssen, davon ab, Ihren Sport auszu√ºben?",
    "Die ganze Zeit", "Zu keinem Zeitpunkt"],

  ["11. Sind Sie zuversichtlich, Ihren Sport gut aus√ºben zu k√∂nnen?",
    "√úberhaupt nicht zuversichtlich", "v√∂llig zuversichtlich"],

  ["12. Sind Sie gelassen, wenn es um die Aus√ºbung Ihres Sports geht?",
    "Gar nicht gelassen", "v√∂llig gelassen"]
];
</script>

<div id="qcontainer"></div>

<script>
const values = [0,10,20,30,40,50,60,70,80,90,100];

let html = "";
for(let i=0;i<q.length;i++){
  const n = i+1;
  html += `
    <div class="qblock">
      <div class="qtitle">${q[i][0]}</div>

      <div class="box">
        <table class="scale">
          <tr>
            ${values.map(v => `<th>${v}</th>`).join("")}
          </tr>
          <tr>
            ${values.map(v =>
              `<td><input type="radio" name="q${n}" value="${v}"></td>`
            ).join("")}
          </tr>
        </table>

        <div class="scale-labels">
          <span>${q[i][1]}</span>
          <span>‚Üî</span>
          <span>${q[i][2]}</span>
        </div>
      </div>

    </div>
  `;
}

document.getElementById("qcontainer").innerHTML = html;
</script>

</form>

<button onclick="calc()">‚úÖ Score berechnen</button>
<button onclick="pdf()">üìÑ PDF erstellen</button>

<div id="result"></div>

<!-- ----------------------- SCORE LOGIC ----------------------- -->

<script>
function calc(){
  let sum = 0;
  let ok = true;

  for(let i=1;i<=12;i++){
    const el = document.querySelector(`input[name="q${i}"]:checked`);
    if(!el){ ok=false; break; }
    sum += Number(el.value);
  }

  if(!ok){
    document.getElementById("result").textContent = "Bitte ALLE 12 Fragen beantworten.";
    return;
  }

  const score = ((sum/1200)*100).toFixed(1);

  document.getElementById("result").textContent =
    `ACL-RSI-Score: ${score}%\n(( ${sum} ) erreichte Punkte) / ((1200) maximale Punkte) √ó 100 = ${score}%`;
}
</script>

<!-- ----------------------- PDF LOGIC ------------------------ -->

<script>
function pdf(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  if(window.robotoBase64){
    doc.addFileToVFS("Roboto-Regular.ttf", window.robotoBase64);
    doc.addFont("Roboto-Regular.ttf", "Roboto", "normal");
    doc.setFont("Roboto");
  }

  let y = 15;
  doc.setFontSize(16);
  doc.text("ACL-RSI ‚Äì Auswertung", 15, y);
  y += 12;

  const lines = document.getElementById("result").innerText.split("\n");
  doc.setFontSize(12);
  lines.forEach(line=>{
    doc.text(line,15,y);
    y += 8;
  });

  doc.save("ACL-RSI.pdf");
}
</script>

<!-- ----------------------- FOOTER ------------------------ -->

<div class="footer-nav">
  <button class="secondary" onclick="goBack()">‚¨ÖÔ∏è Zur√ºck</button>
  <button class="primary" onclick="goHome()">üè† Hauptseite</button>
</div>

<script src="app-core.js"></script>

</body>
</html>
