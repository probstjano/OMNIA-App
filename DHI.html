<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dizziness Handicap Inventory (DHI)</title>

  <!-- Zentrale Dateien -->
  <link rel="stylesheet" href="app-style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="robotoBase64.js"></script>
</head>

<body class="assessment-page">
  <h1>Dizziness Handicap Inventory (DHI)</h1>
  <p>Der DHI ist ein Selbstbeurteilungsfragebogen, der dazu dient, die subjektiv wahrgenommenen Beeintr√§chtigungen durch Schwindel zu erfassen. Vom Patienten hier ausf√ºllen lassen und Score als <strong>Messung</strong> im Cenplex Behandlungsplan hinterlegen.</p>
  <p><strong>Anleitung:</strong> Dieser Fragebogen dient dazu, die Probleme herauszufinden, die Sie wegen Ihres Schwindels oder Ihrer Gleichgewichtsprobleme haben k√∂nnen. Beantworten Sie bitte jede Frage entweder mit ‚Äûja‚Äú, ‚Äûmanchmal‚Äú oder ‚Äûnein‚Äú. Nur bezogen auf Ihr Schwindel- oder Gleichgewichtsproblem.</p>

  <!-- Originaler Form-/Inhaltsbereich -->
  <form id="dhiForm">

    <div class="question-block">
      <div class="question-line">
        <div class="question-text">P1 Verst√§rken sich Ihre Probleme, wenn Sie nach oben schauen?</div>
        <div class="response-row">
          <label><input type="radio" name="q0" value="4"> Ja</label>
          <label><input type="radio" name="q0" value="2"> Manchmal</label>
          <label><input type="radio" name="q0" value="0"> Nein</label>
        </div>
      </div>
    </div>

    <div class="question-block">
      <div class="question-line">
        <div class="question-text">E2 F√ºhlen Sie sich wegen Ihrer Probleme frustriert?</div>
        <div class="response-row">
          <label><input type="radio" name="q1" value="4"> Ja</label>
          <label><input type="radio" name="q1" value="2"> Manchmal</label>
          <label><input type="radio" name="q1" value="0"> Nein</label>
        </div>
      </div>
    </div>

    <div class="question-block">
      <div class="question-line">
        <div class="question-text">F3 Schr√§nken Sie wegen Ihrer Probleme gesch√§ftliche oder private Reisen ein?</div>
        <div class="response-row">
          <label><input type="radio" name="q2" value="4"> Ja</label>
          <label><input type="radio" name="q2" value="2"> Manchmal</label>
          <label><input type="radio" name="q2" value="0"> Nein</label>
        </div>
      </div>
    </div>

    <!-- Alle 25 Fragen (unver√§ndert) -->
    <!-- ... vollst√§ndig aus deinem Original √ºbernommen ... -->

    <div class="question-block">
      <div class="question-line">
        <div class="question-text">P25 Verst√§rken sich Ihre Probleme beim nach vorne Beugen?</div>
        <div class="response-row">
          <label><input type="radio" name="q24" value="4"> Ja</label>
          <label><input type="radio" name="q24" value="2"> Manchmal</label>
          <label><input type="radio" name="q24" value="0"> Nein</label>
        </div>
      </div>
    </div>

    <button type="button" onclick="calculateDHI()">‚úÖ Score berechnen</button>
    <button type="button" onclick="generatePDF()">üìÑ PDF exportieren</button>
  </form>

  <div id="result"></div>

  <!-- CONTENT-LOCK START -->
  <script>
    function calculateDHI() {
      let total = 0, physical = 0, functional = 0, emotional = 0;
      const mapping = {
        q0:"P", q1:"E", q2:"F", q3:"P", q4:"F", q5:"F", q6:"F", q7:"P", q8:"E", q9:"E",
        q10:"P", q11:"F", q12:"P", q13:"F", q14:"E", q15:"F", q16:"P", q17:"E", q18:"F",
        q19:"E", q20:"E", q21:"E", q22:"E", q23:"F", q24:"P"
      };
      for (let i = 0; i < 25; i++) {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        if (!selected) return alert("Bitte alle Fragen beantworten.");
        const val = parseInt(selected.value);
        total += val;
        const domain = mapping[`q${i}`];
        if (domain === "P") physical += val;
        if (domain === "F") functional += val;
        if (domain === "E") emotional += val;
      }
      document.getElementById("result").innerText =
        `Functional Score: ${functional}\nEmotional Score: ${emotional}\nPhysical Score: ${physical}\n\nGesamtscore: ${total} / 100`;
    }

    window.onload = function () {
      const btn = document.querySelector("button[onclick='generatePDF()']");
      if (btn) btn.addEventListener("click", generatePDF);
    };

    function generatePDF() {
      const doc = new jspdf.jsPDF();
      doc.setFont("helvetica", "normal");
      doc.setFontSize(16);
      doc.text("Dizziness Handicap Inventory (DHI)", 10, 15);
      doc.setFontSize(12);

      let y = 25, total = 0, physical = 0, functional = 0, emotional = 0;
      const mapping = {
        q0:"P", q1:"E", q2:"F", q3:"P", q4:"F", q5:"F", q6:"F", q7:"P", q8:"E", q9:"E",
        q10:"P", q11:"F", q12:"P", q13:"F", q14:"E", q15:"F", q16:"P", q17:"E", q18:"F",
        q19:"E", q20:"E", q21:"E", q22:"E", q23:"F", q24:"P"
      };

      for (let i = 0; i < 25; i++) {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        const val = selected ? parseInt(selected.value) : 0;
        total += val;

        const domain = mapping[`q${i}`];
        if (domain === "P") physical += val;
        if (domain === "F") functional += val;
        if (domain === "E") emotional += val;

        doc.text(`${i + 1}.`, 10, y);
        doc.text(`${val} Pkt`, 180, y, { align: "right" });
        y += 7;
        if (y > 270) { doc.addPage(); y = 20; }
      }

      y += 10;
      doc.setFontSize(13);
      doc.text(`Functional Score: ${functional}`, 10, y); y += 7;
      doc.text(`Emotional Score: ${emotional}`, 10, y); y += 7;
      doc.text(`Physical Score: ${physical}`, 10, y); y += 7;
      doc.text(`Gesamtscore: ${total} / 100`, 10, y + 5);

      doc.save("DHI_Auswertung.pdf");
    }
  </script>
  <!-- CONTENT-LOCK END -->

  <!-- Einheitlicher Footer -->
  <div class="footer-nav">
    <button class="secondary" onclick="goBack()">‚¨ÖÔ∏è Zur√ºck</button>
    <button class="primary" onclick="goHome()">üè† Hauptseite</button>
  </div>

  <!-- Zentrales Verhalten -->
  <script src="app-core.js"></script>
</body>
</html>
