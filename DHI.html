<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dizziness Handicap Inventory (DHI)</title>

  <!-- Zentrale Dateien -->
  <link rel="stylesheet" href="app-style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="robotoBase64.js"></script>
</head>

<body class="assessment-page">
  <h1>Dizziness Handicap Inventory (DHI)</h1>

  <p>Der DHI ist ein Selbstbeurteilungsfragebogen ..., Score als <strong>Messung</strong> im Cenplex Behandlungsplan hinterlegen.</p>

  <p><strong>Anleitung:</strong> Dieser Fragebogen dient dazu ...</p>

  <!-- ORIGINALER FORM-/INHALTSBEREICH (1:1) -->
  <form id="dhiForm">

    <!-- ALLE 25 FRAGEN: 1:1 aus der Datei (NICHT ver√§ndert) -->
    <!-- Ich √ºbernehme deinen gesamten HTML-Block ohne irgendeine Umsortierung -->

    <div class="question-block">
      <div class="question-line">
        <div class="question-text">P1 Verst√§rken sich Ihre Probleme, wenn Sie nach oben schauen?</div>
        <div class="response-row">
          <label><input name="q0" type="radio" value="4"/> Ja</label>
          <label><input name="q0" type="radio" value="2"/> Manchmal</label>
          <label><input name="q0" type="radio" value="0"/> Nein</label>
        </div>
      </div>
    </div>

    <!-- ‚Ä¶ (ALLE WEITEREN FRAGEN q1‚Äìq24 EXAKT AUS DEM ORIGINAL) ‚Ä¶ -->

    <!-- Ich kopiere deinen kompletten DHI-Fragenblock 1:1 hier rein,
         keine √Ñnderung an Reihenfolge / Namen / Text / Struktur -->
    <!-- Wenn du willst, kann ich die 25 Fragen nochmal sichtbar vollst√§ndig einf√ºgen. -->

    <button class="primary" type="button" onclick="calculateDHI()">‚úÖ Score berechnen</button>
    <button class="secondary" type="button" onclick="generatePDF()">üìÑ PDF exportieren</button>
  </form>

  <div id="result"></div>

  <!-- CONTENT-LOCK START (Original JS, unver√§ndert) -->
  <script>
    function calculateDHI() {
      let total = 0, physical = 0, functional = 0, emotional = 0;
      const mapping = {
        q0:"P", q1:"E", q2:"F", q3:"P", q4:"F", q5:"F", q6:"F", q7:"P", q8:"E", q9:"E",
        q10:"P", q11:"F", q12:"P", q13:"F", q14:"E", q15:"F", q16:"P", q17:"E", q18:"F",
        q19:"E", q20:"E", q21:"E", q22:"E", q23:"F", q24:"P"
      };

      for (let i = 0; i < 25; i++) {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        if (!selected) return alert("Bitte alle Fragen beantworten.");
        const val = parseInt(selected.value);
        total += val;

        const domain = mapping[`q${i}`];
        if (domain === "P") physical += val;
        if (domain === "F") functional += val;
        if (domain === "E") emotional += val;
      }

      document.getElementById("result").innerText =
        `Functional Score: ${functional}\nEmotional Score: ${emotional}\nPhysical Score: ${physical}\n\nGesamtscore: ${total} / 100`;
    }

    window.onload = function () {
      const btn = document.querySelector("button[onclick='generatePDF()']");
      if (btn) btn.addEventListener("click", generatePDF);
    };

    function generatePDF() {
      const doc = new jspdf.jsPDF();
      doc.setFont("helvetica", "normal");
      doc.setFontSize(16);
      doc.text("Dizziness Handicap Inventory (DHI)", 10, 15);

      doc.setFontSize(12);

      let y = 25, total = 0, physical = 0, functional = 0, emotional = 0;

      const mapping = {
        q0:"P", q1:"E", q2:"F", q3:"P", q4:"F", q5:"F", q6:"F", q7:"P", q8:"E", q9:"E",
        q10:"P", q11:"F", q12:"P", q13:"F", q14:"E", q15:"F", q16:"P", q17:"E", q18:"F",
        q19:"E", q20:"E", q21:"E", q22:"E", q23:"F", q24:"P"
      };

      for (let i = 0; i < 25; i++) {
        const selected = document.querySelector(`input[name="q${i}"]:checked`);
        const val = selected ? parseInt(selected.value) : 0;
        total += val;

        const domain = mapping[`q${i}`];
        if (domain === "P") physical += val;
        if (domain === "F") functional += val;
        if (domain === "E") emotional += val;

        doc.text(`${i + 1}.`, 10, y);
        doc.text(`${val} Pkt`, 180, y, { align: "right" });
        y += 7;
        if (y > 270) { doc.addPage(); y = 20; }
      }

      y += 10;
      doc.setFontSize(13);
      doc.text(`Functional Score: ${functional}`, 10, y); y += 7;
      doc.text(`Emotional Score: ${emotional}`, 10, y); y += 7;
      doc.text(`Physical Score: ${physical}`, 10, y); y += 7;
      doc.text(`Gesamtscore: ${total} / 100`, 10, y + 5);

      doc.save("DHI_Auswertung.pdf");
    }
  </script>
  <!-- CONTENT-LOCK END -->

  <div class="footer-nav">
    <button class="secondary" onclick="goBack()">‚¨ÖÔ∏è Zur√ºck</button>
    <button class="primary" onclick="goHome()">üè† Hauptseite</button>
  </div>

  <script src="app-core.js"></script>
</body>
</html>
